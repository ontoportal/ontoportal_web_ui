- @title = t(".title", organization: "#{$ORG_SITE}")

- unless $FRONT_NOTICE.nil? || $FRONT_NOTICE.empty? || cookies[:front_page_notice_closed].eql?("true")
  :javascript
    function close_message(){
      var exdate = new Date();
      exdate.setDate(exdate.getDate() + 7);
      document.cookie="front_page_notice_closed=true; expires="+exdate.toGMTString();
      jQuery("#notice_message").hide();
    }

  %p#notice_message{:style => "padding: 10px; margin: 10px; border:1px solid #EFEFEF; background-color: #F9F9F9;"}
    = $FRONT_NOTICE
    \&nbsp;&nbsp;
    %a{:href => "#", :onclick => "close_message(); return false;", :style => "font-size: small; color: darkGray;"} [close]

%div.container.pb-4.pb-md-5
  %div.row
    %div.col
      %div.px-2.py-2.pt-md-5.border-bottom.text-center
        %h2
          = t(".welcome", site: "#{$SITE}")
          %small.text-muted
            = t(".tagline")
  %div.row.search.pt-4
    %div.col
      %div.card-deck
        -# Search for a class across ontologies
        %div.card
          %div.card-header Search for a class
          %div.card-body
            = form_tag("/search", method: "get") do
              %div.input-group.mb-3
                - placeholder = t(".query_placeholder")
                = text_field_tag("query", nil, class: "form-control", placeholder: placeholder)
                %div.input-group-append
                  = button_tag(type: "submit", class: "btn btn-primary", aria: {label: "Search for a class"}) do
                    %i{class: "fas fa-search fa-lg", aria: {hidden: "true"}}              
              %a{:href => "/search?opt=advanced"} Advanced Search
        -# Search for an ontology
        %div.card
          %div.card-header Find an ontology
          %div.card-body
            %input#find_ontology_id{:type => "hidden"}
            %div.input-group.mb-3
              = text_field_tag("ontology", nil, id: "find_ontology", class: "form-control", data: {ontologynames: @ontology_names}, placeholder: t(".find_ontology_placeholder"))
              %div.input-group-append
                = button_tag(class: "btn btn-primary", onclick: "jumpToValueOntology()", aria: {label: "Find an ontology"}) do
                  %i{class: "fas fa-search fa-lg", aria: {hidden: "true"}}
            %ul.sf-menu.sf-vertical
              %li
                = link_to("Browse Ontologies", "#", style: "white-space: nowrap; padding: 0px; background: #fff; border: 1px solid #fff;")
                %ul
                  %li
                    = link_to("All", ontologies_path())
                  - @groups.each do |group|
                    %li
                      = link_to(group[:name], ontologies_path(filter: "#{CGI.escape(group[:acronym])}"))
  %div.row.pt-3.statistics
    %div.col
      %div.card-deck
        -# Ontology visits
        %div.card
          %div.card-header Ontology Visits #{"in full #{$SITE} " if at_slice?} (#{@analytics.date.strftime("%B %Y")})
          = content_tag(:div, nil, id: "ontology-visits-chart", class: "card-body", data: {ontnames: @anal_ont_names, ontnumbers: @anal_ont_numbers}) do
            %canvas#myChart
            = link_to("More", visits_path())
        -# Ontology statistics
        %div.card
          %div.card-header #{$SITE} Statistics #{"in full #{$SITE}" if at_slice?}
          %ul.list-group.list-group-flush
            %li.list-group-item 
              %div.d-flex.justify-content-between.align-items-center
                %span Ontologies
                %span= @ont_count
            %li.list-group-item
              %div.d-flex.justify-content-between.align-items-center
                %span Classes
                %span= number_with_delimiter(@cls_count, :delimiter => ",")
            %li.list-group-item
              %div.d-flex.justify-content-between.align-items-center
                %span Individuals
                %span= number_with_delimiter(@individuals_count, :delimiter => ",")
            %li.list-group-item
              %div.d-flex.justify-content-between.align-items-center
                %span Projects
                %span= LinkedData::Client::Models::Project.all.length
            %li.list-group-item
              %div.d-flex.justify-content-between.align-items-center
                %span Users
                %span= LinkedData::Client::Models::User.all.length
  %div.row.pt-3.extra
    %div.col
      %div.card-deck
        -# Latest Notes
        %div.card
          %div.card-header Latest Notes
          %ul.list-group.list-group-flush
            - if @last_notes.nil? || @last_notes.empty?
              %li.list-group-item
                %span No recent notes have been submitted
            - else
              - for note in @last_notes
                %li.list-group-item
                  - begin
                    = link_to "#{note[:subject]} (#{note[:ont_name]})", note_path(CGI.escape(note[:id]))
                    %br/
                    %span{:style => "color: #AAAAAA"}
                      = "#{time_ago_in_words(note[:created])} ago"
                      by #{note[:author]}
                    - if note[:body]
                      %p
                        = truncate(strip_tags(note[:body]), :length => 100)
                        \&nbsp;
                  - rescue
        -# Slices
        %div.card
          %div.card-header Slices
          %ul.list-group.list-group-flush
            - LinkedData::Client::Models::Slice.all.each_with_index do |slice, index|
              - break if index == 10
              - slice_name = "#{slice.name} (#{slice.acronym})"
              - slice_link = "http://#{slice.acronym}.#{$UI_URL.sub("http://", "")}"
              %li.list-group-item
                = link_to slice_name, slice_link
  %div.row.pt-3.supported-by
    %div.col
      %div.card-deck
        %div.card
          %div.card-header Supported by
          %div.logos.supports
            = link_to(image_tag("/assets/logos/supports/numev_logo.png"), "http://www.lirmm.fr/numev", target: '_blank')
            = link_to(image_tag("/assets/logos/supports/ibc_logo.jpg"), "http://www.ibc-montpellier.fr", target: '_blank')
            = link_to(image_tag("/assets/logos/supports/agropolisfondation_logo.png"), "https://www.agropolis-fondation.fr/?lang=en", target: '_blank')
            = link_to(image_tag("/assets/logos/supports/anr_logo.png"), "https://anr.fr/en", target: '_blank')
            = link_to(image_tag("/assets/logos/supports/msca_eu_logo.jpg"), "https://ec.europa.eu/programmes/horizon2020/en/h2020-section/marie-sklodowska-curie-actions", target: '_blank')
  %div.row.pt-3.collaboration
    %div.col
      %div.card-deck
        %div.card
          %div.card-header With the collaboration of
          %div.logos.collaboration
            - logos_folder = '/images/logos/collaboration'
            = link_to(image_tag([logos_folder, 'd2kab_logo.png'].join('/')), "http://d2kab.mystrikingly.com", target: '_blank')
            = link_to(image_tag("/assets/logos/collaboration/lirmm_logo.png"), "http://www.lirmm.fr", target: '_blank')
            = link_to(image_tag("/assets/logos/collaboration/cnrs_logo.jpg"), "http://www.cnrs.fr/en", target: '_blank')
            = link_to(image_tag("/assets/logos/collaboration/inrae_logo.jpg"), "https://www.inrae.fr/en", target: '_blank')
            = link_to(image_tag("/assets/logos/collaboration/um_logo.png"), "https://www.umontpellier.fr/en", target: '_blank')
            = link_to(image_tag("/assets/logos/collaboration/stanford-university_logo.png"), "https://www.stanford.edu", target: '_blank')
